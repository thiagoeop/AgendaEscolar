<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EduSync - Agenda Acadêmica</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{--primary:#4f46e5;--secondary:#10b981}
    body{font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:#f1f5f9}
    .input-field{transition:all .2s;border:1px solid #e6e9ef;border-radius:.5rem;padding:.75rem}
    .tab-active{border-bottom:3px solid var(--primary);color:var(--primary);font-weight:600}
    .msg{display:none;padding:.6rem;border-radius:.5rem;font-size:.95rem;margin-top:.75rem}
    .msg.success{background:rgba(79,70,229,0.08);color:#123}
    .msg.error{background:rgba(220,38,38,0.06);color:#7a1b1b}
  </style>
</head>
<body>
  <div class="min-h-screen flex flex-col">
    <header class="bg-gradient-to-r from-indigo-600 to-emerald-500 text-white py-6">
      <div class="container mx-auto px-4 flex justify-between items-center">
        <div class="flex items-center gap-3"><i class="fas fa-calendar-alt text-3xl"></i><h1 class="text-2xl font-bold">EduSync</h1></div>
      </div>
    </header>

    <main class="flex-grow flex items-center justify-center py-12 px-4">
      <div class="container mx-auto flex flex-col lg:flex-row items-center justify-center gap-12">
        <div class="lg:w-1/2 text-center lg:text-left">
          <h2 class="text-4xl font-bold text-gray-800 mb-4">Gestão Acadêmica <span class="text-indigo-600">Simplificada</span></h2>
          <p class="text-gray-600 mb-6">Organize atividades e acesse o calendário escolar.</p>
        </div>

        <div class="lg:w-1/2 max-w-md w-full">
          <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="flex border-b">
              <button id="login-tab" class="flex-1 py-4 px-6 text-center font-medium tab-active"> <i class="fas fa-sign-in-alt mr-2"></i> Login</button>
              <button id="register-tab" class="flex-1 py-4 px-6 text-center font-medium text-gray-500"> <i class="fas fa-user-plus mr-2"></i> Cadastro</button>
            </div>

            <div id="login-form" class="p-6">
              <label class="block text-gray-700 mb-2">E-mail</label>
              <input id="login-email" type="email" class="w-full input-field mb-4" placeholder="seu@email.com">
              <label class="block text-gray-700 mb-2">Senha</label>
              <input id="login-password" type="password" class="w-full input-field mb-4" placeholder="••••••••">
              <button id="login-btn" class="w-full py-3 rounded-lg text-white font-medium" style="background:var(--primary)"> <i class="fas fa-sign-in-alt mr-2"></i> Entrar</button>
              <div id="login-message" class="msg" role="status"></div>
            </div>

            <div id="register-form" class="p-6 hidden">
              <label class="block text-gray-700 mb-2">Nome Completo</label>
              <input id="register-name" type="text" class="w-full input-field mb-4" placeholder="Seu nome completo">
              <label class="block text-gray-700 mb-2">E-mail</label>
              <input id="register-email" type="email" class="w-full input-field mb-4" placeholder="seu@email.com">
              <label class="block text-gray-700 mb-2">Senha</label>
              <input id="register-password" type="password" class="w-full input-field mb-4" placeholder="••••••••">
              <label class="block text-gray-700 mb-2">Confirmar Senha</label>
              <input id="register-confirm-password" type="password" class="w-full input-field mb-4" placeholder="••••••••">
              <div class="flex items-center mb-4">
                <input id="terms" type="checkbox" class="h-4 w-4 text-indigo-600 mr-2">
                <label for="terms" class="text-sm text-gray-700">Concordo com os Termos</label>
              </div>
              <button id="register-btn" class="w-full py-3 rounded-lg text-white font-medium" style="background:var(--secondary)"><i class="fas fa-user-plus mr-2"></i> Criar Conta</button>
              <div id="register-message" class="msg" role="status"></div>
            </div>

          </div>
        </div>
      </div>
    </main>

    <footer class="bg-white py-6 border-t border-gray-200">
      <div class="container mx-auto px-4 text-center text-sm text-gray-500">© 2024 EduSync</div>
    </footer>
  </div>

  <script>
    // UX helpers
    function showMessage(el, text, type = 'success') {
      el.textContent = text;
      el.className = 'msg ' + (type === 'success' ? 'success' : 'error');
      el.style.display = 'block';
      clearTimeout(el._t);
      el._t = setTimeout(()=>{ el.style.display = 'none'; }, 5000);
    }

    // Storage helpers
    const getUsers = () => JSON.parse(localStorage.getItem('users') || '[]');
    const saveUsers = u => localStorage.setItem('users', JSON.stringify(u));
    const setCurrentUser = u => localStorage.setItem('currentUser', JSON.stringify(u));

    // Tabs
    const loginTab = document.getElementById('login-tab');
    const registerTab = document.getElementById('register-tab');
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    loginTab.addEventListener('click', () => { loginTab.classList.add('tab-active'); registerTab.classList.remove('tab-active'); registerTab.classList.add('text-gray-500'); loginForm.classList.remove('hidden'); registerForm.classList.add('hidden'); });
    registerTab.addEventListener('click', () => { registerTab.classList.add('tab-active'); loginTab.classList.remove('tab-active'); loginTab.classList.add('text-gray-500'); registerForm.classList.remove('hidden'); loginForm.classList.add('hidden'); });

    // Try HEAD then fallback navigation
    async function tryOpenCalendar(target = 'calendarioescolar.html') {
      try {
        const resp = await fetch(target, { method: 'HEAD' });
        if (resp.ok) { window.location.href = target; return true; }
      } catch(_) { /* fetch may fail on file:// — fallback below */ }
      // fallback: attempt navigation anyway
      try { window.location.href = target; return true; } catch (e) { return false; }
    }

    // Login
    document.getElementById('login-btn').addEventListener('click', (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const msgEl = document.getElementById('login-message');

      if (!email || !password) { showMessage(msgEl, 'Preencha e‑mail e senha.', 'error'); return; }

      const users = getUsers();
      const found = users.find(u => u.email === email && u.senha === password);
      if (!found) { showMessage(msgEl, 'Credenciais inválidas.', 'error'); return; }

      setCurrentUser(found);
      showMessage(msgEl, 'Login efetuado. Abrindo calendário...', 'success');
      setTimeout(()=> tryOpenCalendar(), 500);
    });

    // Register
    document.getElementById('register-btn').addEventListener('click', (e) => {
      e.preventDefault();
      const nameEl = document.getElementById('register-name');
      const emailEl = document.getElementById('register-email');
      const passEl = document.getElementById('register-password');
      const confirmEl = document.getElementById('register-confirm-password');
      const termsEl = document.getElementById('terms');
      const msgEl = document.getElementById('register-message');

      const nome = nameEl.value.trim(), email = emailEl.value.trim(), senha = passEl.value, confirm = confirmEl.value;

      if (!nome || !email || !senha || !confirm) { showMessage(msgEl, 'Preencha todos os campos.', 'error'); return; }
      if (senha !== confirm) { showMessage(msgEl, 'As senhas não coincidem.', 'error'); return; }
      if (!termsEl.checked) { showMessage(msgEl, 'Aceite os termos para continuar.', 'error'); return; }

      const users = getUsers();
      if (users.some(u => u.email === email)) { showMessage(msgEl, 'Já existe conta com este e-mail.', 'error'); return; }

      const newUser = { id: Date.now(), nome, email, senha };
      users.push(newUser); saveUsers(users); setCurrentUser(newUser);

      // clear form
      nameEl.value = ''; emailEl.value = ''; passEl.value = ''; confirmEl.value = ''; termsEl.checked = false;
      showMessage(msgEl, 'Conta criada com sucesso. Abrindo calendário...', 'success');

      setTimeout(()=> tryOpenCalendar(), 600);
    });
  </script>
</body>
</html>
